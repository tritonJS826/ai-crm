import {conversationsApi} from "src/apiAutogenerated/typescript-fetch/apis";
import {
  ConversationListModel,
  conversationListModelFromConversationListResponse,
  ConversationModel,
  conversationModelFromConversationWithContact,
  ConversationStatus,
} from "src/models/Conversation";
import {MessageModel, messageModelListFromMessageOutList} from "src/models/Message";
import {SuggestionModel, suggestionModelListFromSuggestionOutList} from "src/models/Suggestion";

export async function getConversationList(
  status?: ConversationStatus,
  offset?: number,
  limit?: number): Promise<ConversationListModel> {

  return conversationListModelFromConversationListResponse(await conversationsApi.listConversations(status, limit, offset));
}

export async function getConversation(conversationId: string): Promise<ConversationModel> {
  return conversationModelFromConversationWithContact(await conversationsApi.getConversation(conversationId));
}

export async function getMessages(conversationId: string, limit?: number, cursor?: string): Promise<MessageModel[]> {
  return messageModelListFromMessageOutList(await conversationsApi.getMessages(conversationId, limit, cursor));
}

type SendMessagePayload={
    conversationId: string;
    text?: string;
    imageUrl?: string;
}

export async function sendMessage(payload: SendMessagePayload): Promise<void> {
  await conversationsApi.sendMessage(payload);
}

export async function getSuggestions(conversationId: string): Promise<SuggestionModel[]> {
  return suggestionModelListFromSuggestionOutList(await conversationsApi.getSuggestions(conversationId));
}

export async function createSuggestions(conversationId: string): Promise<SuggestionModel[]> {
  return suggestionModelListFromSuggestionOutList(await conversationsApi.createSuggestions(conversationId));
}
